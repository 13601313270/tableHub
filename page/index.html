<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>表格</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui">
    <link href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/spectrum/1.8.0/spectrum.min.css" rel="stylesheet">
    <script type="application/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
    <script type="application/javascript" src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="application/javascript" src="//www.tablehub.cn/js/dataTable.js"></script>
    <link href="https://cdn.bootcss.com/jqueryui/1.12.1/jquery-ui.css" rel="stylesheet">
    <link href="https://at.alicdn.com/t/font_384848_27ac7fmkzxzdunmi.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/bootstrap-colorpicker/2.5.1/css/bootstrap-colorpicker.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.bootcss.com/spectrum/1.8.0/spectrum.min.js"></script>
    <script src="https://cdn.bootcss.com/spectrum/1.8.0/i18n/jquery.spectrum-zh-cn.min.js"></script>
    <script type="application/javascript" src="https://cdn.bootcss.com/jquery-datetimepicker/2.5.4/build/jquery.datetimepicker.full.min.js"></script>
    <script type="application/javascript" src="//www.tablehub.cn/js/evalObjAndStr.js"></script>
    <script type="application/javascript" src="//www.tablehub.cn/js/dragging.js"></script>
    <script type="application/javascript" src="http://js.tablehub.cn/tablePlugins/all.js"></script>
    <script>
        var fileId = 35;// window.location.href.match(/\/table\/(\d+)\.html/)[1];
        var isCanEdit = false;
    </script>
    <style>
      body{
        background-color: #e6e6e6;
      }
      .container{
        background-color: #e6e6e6;width:100%;height:100%;margin: 0;padding: 10px;position: relative;
      }
      .table{
        width:0!important;
        margin-top: 0;
        background-color: white;
        table-layout: fixed;
      }
      .table>thead>tr>th{
        width:100px;
      }
      .table>tbody>tr>td{
        width:100px;
        overflow: hidden;
      }
      .idNum{
        background-color: #c3c3c3;border-right:solid 3px #929292;min-width:30px;
      }
      .tableBody{
        margin-left:0px;width:100%;height:100%;overflow: auto;margin-top:0px;
      }
      .tableBody .input-group{
        width:98%;margin-left: 1%;
      }
      .edit .tableBody{
        margin-left:80px;width: calc(100% - 80px);height:calc(100% - 39px);overflow: scroll;margin-top: 39px;cursor: cell;
      }
      .tableRow{
        display: none;position:absolute;left:0;width:80px;top:39px;height:calc(100% - 39px);overflow: hidden;
      }
      .tableThead{
        display: none;
      }
      .edit .table{
        margin: 0 0;
      }
      .edit .tableRow{
        display: block;
      }
      .edit .tableThead{
        display: block;
      }
      #myTabContent{
        position:relative;height: calc(100% - 40px);
      }
      #myTabContent .tab-pane{
        overflow: auto;width: 100%;height: 100%;padding-top: 5px;
      }
    </style>
    <style>
      .trMain{
        background-color: white;
      }
      .trTwo{
        display: none;
        background-color: #EEEEEE;
      }
      .trThree{
        background-color: #E8E8E8;
      }
      .addButton{
        float: right;
      }
      .addButton:after{
        content: '+';
      }
      .table th, .table td{
        text-align: center;
      }
      .table>tbody>tr{
        height: 37px;
      }
      .table>thead{
        background-color: #c3c3c3;
      }
      .edit .editTd{
        background-color: #e5f2ff;
        /*border:solid 2px #0000b8;*/
      }
      .edit .editTdtop{
        border-top:solid 2px #0000b8;
      }
      .edit .editTdbottom{
        border-bottom:solid 2px #0000b8;
      }
      .edit .editTdleft{
        border-left:solid 2px #0000b8;
      }
      .edit .editTdright{
        border-right:solid 2px #0000b8;
      }
      .tableThead thead>tr>th{
        min-width: 60px;border: 1px solid #ddd;white-space:nowrap;vertical-align: middle;padding:0;height:37px;
      }
      .table>tbody>tr>td{
        min-width: 60px;border: 1px solid #ddd;white-space:nowrap;vertical-align: middle;padding:0;height:37px;
      }
      .tableThead>thead th{
        border-bottom: solid 3px #929292!important;
      }
      .tableThead .table>thead>tr>.lieNum{
        position:relative;
      }
      .tableThead .table>thead>tr>.lieNum>div{
        cursor: ew-resize;
        position: absolute;
        right: 0;
        top: 0;
        height: 100%;
        width: 5px;
      }
      .table>tbody>tr>.mergeTd{
        white-space:initial
      }
      .tableBody tr{
        background-color: white;
      }
      .tableBody thead{
        height: 20px;
      }
      .tableBody .table{
        margin-top: -16px;
      }
      .tableBody .table>thead>tr>th{
        border-bottom: none;
      }
      .styleAllSelect{
        float:left;width:60px;height:20px;margin:2px;background-color: white;
      }
      .styleSelect{
        border: solid 1px black;
      }
      .idNumOn{
        background-color:#a7a7a7!important;
        box-shadow: inset 6px -1px 20px 1px #909090;
        color: #e8e8e8;
      }
      .lieNumOn{
        background-color: #a7a7a7!important;
        box-shadow: inset 0px 6px 20px 3px #909090;
        color: #e8e8e8;
      }
      .addTable{
        font-family: iconfont;
        line-height: 40px;
        border: solid 1px rgba(255, 255, 255, 0);
        border-left: solid 1px #bdbdbd;
        width: 50px;
        font-size: 18px;
        text-align: center;
        cursor: pointer;
      }
      .addTable:hover{
        background-color: #e6e6e6;
        border: solid 1px #b5b5b5;
        border-radius: 2px;
      }
      .table td .tdInsertDiv{
        display: table;width: 100%;
      }
      .table td .tdInsertDiv>div{
        display: table-cell;
      }
      .table td .tdInsertDiv>div:nth-child(2){
        white-space: normal;
        display: block;
        height:1rem;
      }
      .table td .tdInsertDiv>div:nth-child(2)>span{
        /*max-width: 100px;*/
        display: inline-block;
      }
      .table td .tdInsertDiv>div:first-child{
        text-align: left;
      }
      .table td .tdInsertDiv>div:last-child{
        text-align: right;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <!-- built files will be auto injected -->
    <script>
        var tdData = [];
        var allEcharts = [];
        //表格完成对象
        function tableReady(){
        }
        tableReady.prototype = new obj();
        var readyObj = new tableReady();
        function writeTd(tableNum,tdPos,str,xfIndex){
            if(allTD['td:'+tableNum+'!'+tdPos]==undefined){
                var thisTd = new td(tableNum,tdPos);
            }else{
                var thisTd = allTD['td:'+tableNum+'!'+tdPos];
            }
            thisTd.xfIndex = xfIndex;
            if(str===null){
                thisTd.set('');
            }else if(typeof str=='string' && str.substr(0,1)=='='){
                str = str.match(/=(.*)/)[1];
                thisTd.set(getEvalObj(tableNum,str,true));
            }else{
                thisTd.set(str);
            }
            readyObj.bind(thisTd);
        }
    </script>
    <script>
        function selectTd(){
            if($(this).attr('cell_xf')==undefined){
                $('.toolsContent [data-name=color]').css('color','');
                $('.toolsContent [data-name=bold]').removeClass('active');
                $('.toolsContent [data-name=size]').val('');
                $('.toolsContent [data-name=underline]').removeClass('active');
                $('.toolsContent [data-name=italic]').removeClass('active');
                $('.toolsContent [data-name=fill]').css('backgroundColor','white');
                $('.toolsContent [data-name=tdMerge]').removeClass('active');
            }else{
                var cell_xf = getCellXfCollection[$(this).attr('cell_xf')];
                if(cell_xf.font){
                    if(cell_xf.font.color){
                        $('.toolsContent [data-name=color]').css('color','#'+cell_xf.font.color.slice(2));
                    }
                    if(cell_xf.font.bold===1){
                        $('.toolsContent [data-name=bold]').addClass('active');
                    }else{
                        $('.toolsContent [data-name=bold]').removeClass('active');
                    }
                    if(cell_xf.font.size){
                        $('.toolsContent [data-name=size]').val(cell_xf.font.size);
                    }
                    if(cell_xf.font.underline==='single'){
                        $('.toolsContent [data-name=underline]').addClass('active');
                    }else{
                        $('.toolsContent [data-name=underline]').removeClass('active');
                    }
                    if(cell_xf.font.italic===1){
                        $('.toolsContent [data-name=italic]').addClass('active');
                    }else{
                        $('.toolsContent [data-name=italic]').removeClass('active');
                    }
                }
                if(cell_xf.fill && cell_xf.fill.fillType!=='none'){
                    $('.toolsContent [data-name=fill]').css('backgroundColor','#'+cell_xf.fill.startColor.slice(2));
                }
                else{
                    $('.toolsContent [data-name=fill]').css('backgroundColor','white');
                }
                if(cell_xf.alignment){
                    $('.toolsContent [data-name=horizontal_left]').removeClass('active');
                    $('.toolsContent [data-name=horizontal_center]').removeClass('active');
                    $('.toolsContent [data-name=horizontal_right]').removeClass('active');
                    if(cell_xf.alignment.horizontal=='left'){
                        $('.toolsContent [data-name=horizontal_left]').addClass('active');
                    }else if(cell_xf.alignment.horizontal=='center'){
                        $('.toolsContent [data-name=horizontal_center]').addClass('active');
                    }else if(cell_xf.alignment.horizontal=='right'){
                        $('.toolsContent [data-name=horizontal_right]').addClass('active');
                    }else if(cell_xf.alignment.horizontal=='general'){
                    }
                }
            }
            if(this!==window && !$(this).is('.mergeTd')){
                $('.toolsContent [data-name=tdMerge]').removeClass('active');
                $('.toolsContent [data-name=tdMerge]').addClass('disabled');
            }else{
                var isHasMerge = false;
                var activeId = $('#myTabContent .active').data('tableid');
                for(var i in tdData[activeId].mergeCells){
                    if(i.split(":")[0] == getCellTemp2($(this).attr('hang'),$(this).attr('lie'))){
                        isHasMerge = true;break;
                    }
                }
                if(isHasMerge){
                    $('.toolsContent [data-name=tdMerge]').addClass('active');
                }else{
                    $('.toolsContent [data-name=tdMerge]').removeClass('active');
                }
                $('.toolsContent [data-name=tdMerge]').removeClass('disabled');
            }
        }
        //拖动选择dom
        var isSelectDoms = false;
        var beginSelect = [];
        var echartsObj;
        function setTdSelectState(){
            $('body .edit td').removeClass('editTd');
            $('body .edit td').removeClass('editTdtop');
            $('body .edit td').removeClass('editTdbottom');
            $('body .edit td').removeClass('editTdleft');
            $('body .edit td').removeClass('editTdright');
            $(this).addClass('editTd');
            $(this).addClass('editTdtop');
            $(this).addClass('editTdbottom');
            $(this).addClass('editTdleft');
            $(this).addClass('editTdright');
        }
    </script>
  </body>
</html>
